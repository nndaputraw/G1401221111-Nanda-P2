---
title: "Tugas Minggu 4 MPDW"
author: "Nabil Bintang Prayoga"
date: "2024-09-13"
output: rmdformats::readthedown
---

# White Noise

Proses pembangkitan suatu model deret waktu diawali dengan membangkitkan data white noise yang tidak memiliki autokorelasi dengan nilai harapan tertentu dan ragam yang konstan.

```{r}
set.seed(2024)
wn <- rnorm(300)
ts.plot(wn)
```

# MA(2)

Dalam kasus ini, akan dibangkitkan suatu data dengan model MA(2) sebanyak 300 data yang memiliki nilai $\theta_1 = 0.4$ dan $\theta_2 = 0.6$. Rumusan model tersebut adalah sebagai berikut

$$
y_t = e_t-0.4e_{t-1}-0.6e_{t-2}
$$

```{r}
set.seed(2024)
ma[1] <- wn[1]
ma[2] <- ma[2] - 0.4 * ar[1]
```

```{r}
for(i in 3:300){
   ma[i] <- wn[i] - 0.4 * wn[i - 1] - 0.6 * wn[i - 2]
}
ma
```

Pembangkitan model MA(2) juga dapat dilakukan dengan menerapkan fungsi `arima.sim()`

```{r}
ma2 <- arima.sim(list(order=c(0,0,2), ma=c(0.4, 0.6)), n=300)
ma2
```

## Karakteristik MA(2)

### Plot Time Series

```{r}
ts.plot(ma)
```

Berdasarkan plot time series, terlihat bahwa data MA(2) yang dibangkitkan stasioner dalam rataan

### Plot ACF

```{r}
acf(ma,lag.max = 20)
```

Berdasarkan plot AFC tersebut, terlihat bahwa plot ACF *cuts off* di lag kedua

### Plot PACF

```{r}
pacf(ma)
```

Berdasarkan plot PACF tersebut, terlihat bahwa plot PACF cenderung *tails off* dan membentuk gelombang lembah karena nilai teta adalah positif

### Plot EACF

```{r}
TSA::eacf(ma)
```

Berdasarkan pola segitiga nol pada plot EACF, terlihat bahwa segitiga nol berada pada ordo AR(0) dan ordo MA(2)

### Scatterplot Antar Lag

#### Korelasi antara $Y_t$ dengan $Y_{t-1}$

```{r}
yt_ma <- ma[-1]
yt_ma

yt_1_ma <- ma[-300]
yt_1_ma
```

```{r}
plot(y=yt_ma,x=yt_1_ma)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan negatif antara $Y_t$ dengan $Y_{t-1}$.

```{r}
cor(yt_ma,yt_1_ma)
```

Korelasi antara $Y_t$ dengan $Y_{t-1}$ dari hasil simulasi mendekati perhitungan teoritis yaitu

$$
\rho_1=\frac{-\theta_1+\theta_1\theta_2}{1+\theta_1+\theta_2}=\frac{-0.4+0.4\times0.6}{1+0.4+0.6}=-0.08
$$

#### Korelasi antara $Y_t$ dengan $Y_{t-2}$

```{r}
yt_ma2 <- ma[-c(1,2)]
yt_ma2

yt_2_ma <- ma[-c(299,300)]
yt_2_ma
```

```{r}
plot(y=yt_ma2,x=yt_2_ma)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan negatif antara $Y_t$ dengan $Y_{t-2}$.

```{r}
cor(yt_ma2,yt_2_ma)
```

Korelasi antara $Y_t$ dengan $Y_{t-2}$ dari hasil simulasi tergolong mendekati perhitungan teoritis yaitu

$$
\rho_2=\frac{-\theta_2}{1+\theta_1+\theta_2}=\frac{-0.4+0.4\times0.6}{1+0.4+0.6}=-0.3
$$

#### Korelasi antara $Y_t$ dengan $Y_{t-3}$

```{r}
yt_ma3 <- ma[-c(1,2,3)]
yt_ma3

yt_3_ma <- ma[-c(288, 299,300)]
yt_3_ma
```

```{r}
plot(y=yt_ma3,x=yt_3_ma)
```

Berdasarkan scatterplot tersebut, terlihat bahwa $Y_t$ dan $Y_{t-3}$ sudah menunjukkan pola yang tidak beraturan atau bisa disebut tidak berpola.

```{r}
cor(yt_ma3,yt_3_ma)
```

Korelasi antara $Y_t$ dengan $Y_{t-3}$ dari hasil simulasi mendekati nilai teoritis yang menyatakan bahwa $\rho_k=0$ untuk k>q

# AR(2)

Dalam kasus ini, akan dibangkitkan suatu data dengan model MA(2) sebanyak 300 data yang memiliki nilai $\phi_1 = 0.5$ dan $\phi_2 = 0.2$. Rumusan model tersebut adalah sebagai berikut

$$ Y_t = e_t+0.5Y_{t-1}+0.2Y_{t-2} $$

```{r}
set.seed(2024)
ar[1] <- wn[1]
ar[2] <- wn[2] + 0.5 * ar[1]
```

```{r}
for (i in 3:300) {
  ar[i] <- wn[i] + 0.5 * ar[i-1] + 0.2 * ar[i-2]
}
ar
```

Pembangkitan model AR(2) juga dapat dilakukan dengan menerapkan fungsi `arima.sim()`

```{r}
ar2 <- arima.sim(list(order=c(2,0,0), ar=c(0.5,0.2)), n=300)
ar2
```

## Karakteristik AR(2)

### Plot Time Series

```{r}
ts.plot(ar)
```

Berdasarkan plot time series tersebut terlihat bahwa data cenderung stasioner pada rataan

### Plot ACF

```{r}
acf(ar)
```

Berdasarkan plot ACF tersebut terlihat bahwa plot ACF cenderung *tails off* dan cenderung membentuk pola grafik sinus

### Plot PACF

```{r}
pacf(ar)
```

Berdasarkan plot PACF tersebut, terlihat bahwa plot PACF *cuts off* pada lag kedua, sejalan dengan teori yang ada

### Plot EACF (Extended)

```{r}
TSA::eacf(ar)
```

Berdasarkan pola segitiga nol pada plot EACF, terlihat bahwa segitiga nol berada pada ordo AR(2) dan ordo MA(0)

### Scatterplot Antar Lag

#### Korelasi antara $Y_t$ dengan $Y_{t-1}$

```{r}
yt_ar <- ar[-1]
yt_ar

yt_1_ar <- ar[-300]
yt_1_ar
```

```{r}
plot(y=yt_ar,x=yt_1_ar)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-1}$.

```{r}
cor(yt_ar,yt_1_ar)
```

Korelasi antara $Y_t$ dengan $Y_{t-1}$ dari hasil simulasi mendekati perhitungan teoritis yaitu

$$
\rho_1=\frac{\phi_1}{1-\phi_2}=\frac{0.5}{1-0.2}=0.625
$$

#### Korelasi antara $Y_t$ dengan $Y_{t-2}$

```{r}
yt_ar2 <- ar[-c(1,2)]
yt_ar2

yt_2_ar <- ar[-c(299,300)]
yt_2_ar
```

```{r}
plot(y=yt_ar2,x=yt_2_ar)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-2}$.

```{r}
cor(yt_ar2,yt_2_ar)
```

Korelasi antara $Y_t$ dengan $Y_{t-2}$ dari hasil simulasi mendekati perhitungan teoritis yaitu

$$
\rho_2=\phi_1\rho_{k-1}+\phi_2\rho_{k-2}=\frac{\phi_2(1-\phi_2)+\phi_1^2}{1-\phi_2}=\frac{0.2(1-0.2)+0.5^2}{1-0.2}=0.5125
$$

#### Korelasi antara $Y_t$ dengan $Y_{t-3}$

```{r}
yt_ar3 <- ar[-c(1,2,3)]
yt_ar3

yt_3_ar <- ar[-c(298,299,300)]
yt_3_ar
```

```{r}
plot(y=yt_ar3,x=yt_3_ar)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-3}$.

```{r}
cor(yt_ar3,yt_3_ar)
```

Korelasi antara $Y_t$ dengan $Y_{t-3}$ dari hasil simulasi mendekati perhitungan teoritis yaitu

$$
\rho_3=\phi_1\rho_{k-1}+\phi_2\rho_{k-2}=\phi_1\rho_2+\phi_2\rho_1=0.5\times0.5125+0.2\times0.625=0.38125
$$

# ARMA(2,2)

Dalam kasus ini, akan dibangkitkan suatu data dengan model ARMA(2,2) sebanyak 300 data yang memiliki nilai $\phi_1 = 0.5$ dan $\phi_2 = 0.2$ serta $\theta_1 = 0.4$ dan $\theta_2 = 0.6$. Rumusan model tersebut adalah sebagai berikut

$$ Y_t = 0.5Y_{t-1}+0.2Y_{t-2}+e_t-0.4_{t-1}-0.6_{t-2} $$

```{r}
set.seed(2024)
phi1 = 0.5
phi2 = 0.2
theta1 = 0.4
theta2 = 0.6

y.arma=c(1:300)
for (i in 3:300){y.arma[i] = phi1*y.arma[i-1] + phi2*y.arma[i-2] +
                 wn[i] - theta1*wn[i-1] - theta2*wn[i-2]}
y.arma
```

Pembangkitan model ARMA(2,2) juga dapat dilakukan dengan menerapkan fungsi `arima.sim()`

```{r}
arma22 <- arima.sim(list(order=c(2,0,2), ar = c(0.5,0.2), ma = c(0.4,0.6)), n=300)
arma22
```

## Karakteristik ARMA(2,2)

### Plot Time Series

```{r}
ts.plot(y.arma)
```

Berdasarkan plot time series tersebut, terlihat bahwa model ARMA(2,2) cenderung stasioner dalam rataan

### Plot ACF

```{r}
acf(y.arma)
```

Berdasarkan plot ACF tersebut, terlihat bahwa model ARMA(2,2) hasil simulasi memiliki plot ACF yang *tails off*

### Plot PACF

```{r}
pacf(y.arma)
```

Berdasarkan plot PACF tersebut, terlihat bahwa model ARMA(1,1) hasil simulasi memiliki plot PACF yang *tails off*

### Plot EACF

```{r}
TSA::eacf(y.arma)
```

Berdasarkan pola segitiga nol pada plot EACF, terlihat bahwa segitiga nol berada pada ordo AR(2) dan ordo MA(2)

### Scatterplot Antar Lag

#### Korelasi antara $Y_t$ dengan $Y_{t-1}$

```{r}
yt_arma <- y.arma[-1]
yt_arma

yt_1_arma <- y.arma[-300]
yt_1_arma
```

```{r}
plot(y=yt_arma,x=yt_1_arma)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan positif antara $Y_t$ dengan $Y_{t-1}$.

```{r}
cor(yt_arma,yt_1_arma)
```

Korelasi antara $Y_t$ dengan $Y_{t-1}$ dari hasil simulasi mendekati perhitungan teoritis yaitu

$$
???
$$

#### Korelasi antara $Y_t$ dengan $Y_{t-2}$

```{r}
yt_arma <- y.arma[-c(1,2)]
yt_arma

yt_2_arma <- y.arma[-c(299,300)]
yt_2_arma
```

```{r}
plot(y=yt_arma,x=yt_2_arma)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan negatif antara $Y_t$ dengan $Y_{t-2}$.

```{r}
cor(yt_arma,yt_2_arma)
```

Korelasi antara $Y_t$ dengan $Y_{t-2}$ dari hasil simulasi mendekati perhitungan teoritis yaitu

$$
???
$$

#### Korelasi antara $Y_t$ dengan $Y_{t-3}$

```{r}
yt_arma <- y.arma[-c(1,2,3)]
yt_arma

yt_3_arma <- y.arma[-c(298,299,300)]
yt_3_arma
```

```{r}
plot(y=yt_arma,x=yt_3_arma)
```

Berdasarkan scatterplot tersebut, terlihat bahwa terdapat hubungan negatif antara $Y_t$ dengan $Y_{t-3}$.

```{r}
cor(yt_arma,yt_3_arma)
```

Korelasi antara $Y_t$ dengan $Y_{t-3}$ dari hasil simulasi mendekati perhitungan teoritis yaitu

$$
???
$$
